<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ËÑ≥Ê±Å„Ç™„É™„Éë | ÈÇÑÂÖÉÁéáÁâπÂåñÁâà</title>
<style>
  :root {
    --gold: #FFD700;
    --red: #ff2a2a;
    --blue: #2a2aff;
    --green: #2aff2a;
    --rainbow: linear-gradient(135deg, #ff2400, #e81d1d, #e8b71d, #e3e81d, #1de840, #1ddde8, #2b1de8, #dd00f3, #dd00f3);
    --bg-dark: #050505;
  }

  body {
    margin: 0;
    background-color: var(--bg-dark);
    color: #fff;
    font-family: "Arial Black", sans-serif;
    overflow: hidden; 
    display: flex;
    flex-direction: column;
    height: 100vh;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
  }

  /* --- „Éò„ÉÉ„ÉÄ„Éº --- */
  header {
    background: rgba(0,0,0,0.95);
    padding: 10px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 2px solid #333;
    z-index: 100;
    box-shadow: 0 5px 20px rgba(0,0,0,0.8);
    height: 60px;
    box-sizing: border-box;
  }
  .header-title { font-style: italic; font-size: 18px; }
  .points-box {
    background: linear-gradient(to right, #222, #444);
    padding: 5px 15px;
    border-radius: 20px;
    border: 2px solid var(--gold);
    color: var(--gold);
    font-weight: bold;
    text-shadow: 0 0 5px var(--gold);
    font-size: 14px;
  }

  /* --- „É°„Ç§„É≥„Ç®„É™„Ç¢ÔºàÁ∏¶„Çπ„ÇØ„É≠„Éº„É´Ôºâ --- */
  .main-stage {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    padding-bottom: 100px;
    background-image: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
  }

  /* „Ç¨„ÉÅ„É£„ÅÆÁÆ± */
  .gacha-box {
    background: #111;
    border: 1px solid #333;
    border-radius: 12px;
    margin-bottom: 40px;
    padding: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  }

  .banner {
    width: 100%;
    height: 150px;
    background: #000;
    margin-bottom: 15px;
    border-radius: 8px;
    border: 2px solid #444;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    background-size: cover;
    background-position: center;
  }
  .banner-text {
    font-size: 28px; font-weight: 900; z-index: 2;
    text-shadow: 0 4px 10px rgba(0,0,0,0.8);
  }
  .banner-sub {
    font-size: 12px; color: #ddd; z-index: 2;
    background: rgba(0,0,0,0.6); padding: 2px 8px;
    border-radius: 4px; margin-top: 5px;
  }

  /* „Éú„Çø„É≥Áæ§ */
  .gacha-controls {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
  }
  .gacha-btn {
    border: none;
    padding: 12px 0;
    font-size: 13px;
    font-weight: 900;
    color: white;
    border-radius: 8px;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: transform 0.1s;
    text-shadow: 0 2px 0 rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .gacha-btn:active { transform: scale(0.95); }
  
  .btn-single {
    background: linear-gradient(180deg, #555 0%, #333 100%);
    box-shadow: 0 4px 0 #222;
    grid-column: 1 / 3;
  }
  .btn-10 {
    background: linear-gradient(180deg, #e94343 0%, #a82e2e 100%);
    box-shadow: 0 4px 0 #681515;
  }
  .btn-100 {
    background: linear-gradient(180deg, #e9b443 0%, #a8822e 100%);
    box-shadow: 0 4px 0 #685015;
  }
  .cost-label { font-size: 10px; margin-top: 2px; opacity: 0.9; font-weight: normal; }

  /* --- „Éï„ÉÉ„Çø„Éº„É°„Éã„É•„Éº --- */
  .footer-menu {
    background: #111;
    border-top: 1px solid #333;
    display: flex;
    justify-content: space-around;
    padding: 10px 0;
    position: fixed; bottom: 0; left: 0; width: 100%;
    z-index: 900;
    height: 60px;
    box-sizing: border-box;
  }
  .menu-item {
    color: #888;
    text-align: center;
    font-size: 10px;
    cursor: pointer;
    width: 50%;
  }
  .menu-item:active { opacity: 0.7; }
  .menu-icon { font-size: 20px; display: block; margin-bottom: 2px; }

  /* --- ÊºîÂá∫„Ç™„Éº„Éê„Éº„É¨„Ç§ („Éë„ÉÅ„É≥„Ç≥„Éë„Éº„Éà) --- */
  .cutin-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.95);
    z-index: 2000;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .aura-orb {
    width: 150px; height: 150px;
    border-radius: 50%;
    margin-bottom: 50px;
    position: relative;
    transition: all 0.3s ease;
    animation: float 2s ease-in-out infinite;
  }
  .aura-orb.blue { background: radial-gradient(circle, #fff, var(--blue)); box-shadow: 0 0 60px var(--blue); }
  .aura-orb.green { background: radial-gradient(circle, #fff, var(--green)); box-shadow: 0 0 60px var(--green); }
  .aura-orb.red { background: radial-gradient(circle, #fff, var(--red)); box-shadow: 0 0 80px var(--red); animation: shake-hard 0.2s infinite; }
  .aura-orb.rainbow { background: var(--rainbow); box-shadow: 0 0 100px #ff00de; animation: spin 1s linear infinite; }

  .push-btn {
    width: 100px; height: 100px;
    border-radius: 50%;
    border: 4px solid #fff;
    background: radial-gradient(circle, #ff0000 0%, #880000 100%);
    color: #fff;
    font-size: 20px;
    font-weight: 900;
    cursor: pointer;
    box-shadow: 0 0 30px rgba(255,0,0,0.5), inset 0 0 20px rgba(0,0,0,0.5);
    animation: pulse-btn 0.5s infinite alternate;
    display: flex; align-items: center; justify-content: center;
    z-index: 2001;
  }
  .push-btn:active { transform: scale(0.9); }

  .cutin-text {
    position: absolute; top: 50%; left: 50%;
    transform: translate(-50%, -50%) scale(0);
    font-size: 60px; font-weight: 900; color: #fff;
    text-shadow: 0 0 20px red; white-space: nowrap;
    z-index: 3000; pointer-events: none;
  }
  .cutin-anim { animation: cutin-show 0.6s ease-out forwards; }

  /* --- ÁµêÊûúÔºÜ„Ç§„É≥„Éô„É≥„Éà„É™ÂÖ±ÈÄö„Ç∞„É™„ÉÉ„Éâ --- */
  .overlay-screen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #111;
    z-index: 1500;
    display: none;
    flex-direction: column;
    padding: 10px;
    box-sizing: border-box;
  }
  
  .screen-header {
    text-align: center; margin-bottom: 10px;
    font-size: 18px; color: #fff; border-bottom: 1px solid #333; padding-bottom: 10px;
    display: flex; justify-content: space-between; align-items: center;
    height: 40px;
  }
  
  .back-btn {
    background: none; border: 1px solid #666; color: #ddd;
    padding: 5px 12px; border-radius: 20px; font-size: 12px; cursor: pointer;
    display: flex; align-items: center; gap: 5px;
  }
  .back-btn:hover { background: #333; color: #fff; border-color: #fff; }

  .scroll-area {
    flex: 1; overflow-y: auto; padding-bottom: 80px;
  }

  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
    gap: 8px;
  }

  .grid-card {
    aspect-ratio: 2/3;
    background: #222;
    border-radius: 6px;
    border: 1px solid #444;
    position: relative;
    overflow: hidden;
    cursor: pointer;
  }
  /* Â£≤Âç¥ÈÅ∏ÊäûÊôÇ„ÅÆ„Çπ„Çø„Ç§„É´ */
  .grid-card.selected {
    border: 3px solid #ff4444;
    opacity: 0.6;
  }
  .grid-card.selected::after {
    content: "Â£≤Âç¥";
    position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
    background: red; color: white; font-size: 12px; padding: 2px 6px; border-radius: 4px;
  }

  .grid-card.SSR { border: 2px solid var(--gold); box-shadow: 0 0 10px rgba(255, 215, 0, 0.3); }
  .grid-card.SR { border: 1px solid #ffaa00; }
  
  .grid-card img { width: 100%; height: 100%; object-fit: cover; }
  .grid-card .info {
    position: absolute; bottom: 0; width: 100%;
    background: rgba(0,0,0,0.85);
    color: #fff; font-size: 9px; text-align: center; padding: 3px 0;
  }

  /* --- ‰∏ãÈÉ®Âõ∫ÂÆö„Ç¢„ÇØ„Ç∑„Éß„É≥„Éê„Éº (Â£≤Âç¥Áî®) --- */
  .action-bar {
    position: absolute; bottom: 0; left: 0; width: 100%;
    background: #222; border-top: 1px solid #444;
    padding: 15px; box-sizing: border-box;
    display: flex; justify-content: space-between; align-items: center;
  }
  .sell-btn {
    background: #ff4444; color: #fff; border: none; padding: 10px 20px;
    border-radius: 20px; font-weight: bold; cursor: pointer;
  }
  .sell-btn:disabled { background: #555; color: #888; }

  /* --- „Éõ„ÉØ„Ç§„Éà„Ç¢„Ç¶„Éà --- */
  .flash-bang {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: white; z-index: 5000; opacity: 0; pointer-events: none;
  }
  .flash-active { animation: flash 0.5s ease-out forwards; }

  /* „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÂÆöÁæ© */
  @keyframes pulse { to { transform: scale(1.05); } }
  @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
  @keyframes shake-hard { 0% { transform: translate(2px, 2px); } 100% { transform: translate(-2px, -2px); } }
  @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  @keyframes pulse-btn { 0% { transform: scale(1); box-shadow: 0 0 10px red; } 100% { transform: scale(1.1); box-shadow: 0 0 30px red; } }
  @keyframes flash { 0% { opacity: 0; } 20% { opacity: 1; } 100% { opacity: 0; } }
  @keyframes cutin-show { 
    0% { transform: translate(-50%, -50%) scale(0) rotate(-10deg); opacity: 0; } 
    60% { transform: translate(-50%, -50%) scale(1.2) rotate(0deg); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 1; }
  }

</style>
</head>
<body>

<header>
  <div class="header-title">ËÑ≥Ê±ÅORIPA</div>
  <div class="points-box" id="headerPoints">999,999,999 pt</div>
</header>

<div class="main-stage" id="gachaContainer">
  </div>

<div class="footer-menu">
  <div class="menu-item" onclick="showMain()">
    <span class="menu-icon">üè†</span>„Ç¨„ÉÅ„É£
  </div>
  <div class="menu-item" onclick="openInventory()">
    <span class="menu-icon">üÉè</span>„Ç´„Éº„Éâ‰∏ÄË¶ß/Â£≤Âç¥
  </div>
</div>

<div class="cutin-overlay" id="cutinOverlay">
  <div style="color:#fff; margin-bottom:20px; font-weight:bold; letter-spacing:2px;">TAP TO CHARGE!</div>
  <div class="aura-orb blue" id="auraOrb"></div>
  <div class="push-btn" id="pushBtn">PUSH</div>
  <div class="cutin-text" id="cutinText">ÊøÄÁÜ±!!</div>
</div>

<div class="overlay-screen" id="resultScreen">
  <div class="screen-header">
    <span>RESULT</span>
    <button class="back-btn" onclick="closeResult()">√ó Èñâ„Åò„Çã</button>
  </div>
  <div class="scroll-area">
    <div class="card-grid" id="resultGrid"></div>
  </div>
</div>

<div class="overlay-screen" id="inventoryScreen">
  <div class="screen-header">
    <button class="back-btn" onclick="showMain()">‚Üê Êàª„Çã</button>
    <span>ÊâÄÊúâ„Ç´„Éº„Éâ</span>
    <div style="width:50px;"></div> </div>
  <div class="scroll-area">
    <div class="card-grid" id="inventoryGrid"></div>
  </div>
  <div class="action-bar">
    <div style="color:#fff; font-size:12px;">
      ÈÅ∏Êäû‰∏≠: <span id="sellCount">0</span>Êûö<br>
      Â£≤Âç¥È°ç: <span id="sellValue" style="color:var(--gold); font-size:16px;">0</span> pt
    </div>
    <button class="sell-btn" id="sellBtn" onclick="sellSelectedCards()" disabled>„Åæ„Å®„ÇÅ„Å¶Â£≤Âç¥</button>
  </div>
</div>

<div class="flash-bang" id="flashBang"></div>

<script>
  // --- Ë®≠ÂÆö„Éá„Éº„Çø ---
  let userPoints = 999999999; // „ÉÜ„Çπ„ÉàÁî®ÁÑ°Èôê„Éù„Ç§„É≥„Éà
  let myCards = []; 

  // ‚òÖ ÈÇÑÂÖÉÁéáË®≠Ë®àÔºàÊúüÂæÖÂÄ§92-96% / ÊúÄ‰Ωé‰øùË®º80-90%Ôºâ
  const TIERS = [
    {
      price: 500,
      name: "BEGINNER", 
      sub: "ÊúÄ‰Ωé‰øùË®º400pt (80%) ÂÆâÂøÉË®≠Ë®à",
      colors: ["#333", "#555"],
      pool: [
        // SSR: 0.5% (ÈÇÑÂÖÉÁéá 4000%)
        { r:"SSR", w:0.5, pt:20000, name:"ÈùíÁúº„ÅÆÂ∑®Á•û" },
        // SR: 3% (ÈÇÑÂÖÉÁéá 600%)
        { r:"SR", w:3, pt:3000, name:"Ë¶ãÁøí„ÅÑÈ≠îÂ∞éÂ∏´" },
        // R: 20% (ÈÇÑÂÖÉÁéá 110%)
        { r:"R", w:20, pt:550, name:"Êà¶Â£´„ÅÆÂâ£" },
        // C: 76.5% (ÈÇÑÂÖÉÁéá 80-90%)
        { r:"C", w:76.5, pt:420, name:"„Åü„Å†„ÅÆÁü≥" }
      ]
    },
    {
      price: 1000,
      name: "STANDARD", 
      sub: "ÊúüÂæÖÂÄ§94% / „Éè„Ç§„É™„Çπ„ÇØ„Éè„Ç§„É™„Çø„Éº„É≥",
      colors: ["#004400", "#002200"],
      pool: [
        // SSR: 1% (ÈÇÑÂÖÉÁéá 5000%)
        { r:"SSR", w:1, pt:50000, name:"Á¥ÖËìÆ„ÅÆÁ´úÁéã" },
        // SR: 5% (ÈÇÑÂÖÉÁéá 500%)
        { r:"SR", w:5, pt:5000, name:"„Ç®„É´„Éï„ÅÆÂâ£Â£´" },
        // R: 20% (ÈÇÑÂÖÉÁéá 110%)
        { r:"R", w:20, pt:1100, name:"È≠îÊ≥ï„ÅÆÂ£∫" },
        // C: 74% (ÈÇÑÂÖÉÁéá 85%)
        { r:"C", w:74, pt:850, name:"„Ç¥„Éñ„É™„É≥" }
      ]
    },
    {
      price: 2000,
      name: "ULTIMATE", 
      sub: "‰∏ÄÊíÉÂøÖÊÆ∫ / Â§©ÂõΩ„ÅãÂú∞ÁçÑ„Åã",
      colors: ["#440000", "#220000"],
      pool: [
        // SSR: 1.5% (ÈÇÑÂÖÉÁéá 7500%)
        { r:"SSR", w:1.5, pt:150000, name:"ÂÖâ„ÅÆÂâµÈÄ†Á•û" },
        // SR: 8% (ÈÇÑÂÖÉÁéá 500%)
        { r:"SR", w:8, pt:10000, name:"ÊöóÈªíÈ®éÂ£´" },
        // R: 25% (ÈÇÑÂÖÉÁéá 105%)
        { r:"R", w:25, pt:2100, name:"ËòáÁîüÈ≠îÊ≥ï" },
        // C: 65.5% (ÈÇÑÂÖÉÁéá 80%)
        { r:"C", w:65.5, pt:1600, name:"„Çπ„É©„Ç§„É†" }
      ]
    }
  ];

  // --- ÂàùÊúüÂåñ ---
  updateUI();
  renderGachaList();

  // --- ÁîªÈù¢ÊèèÁîª ---
  function renderGachaList() {
    const container = document.getElementById('gachaContainer');
    container.innerHTML = "";

    TIERS.forEach(tier => {
      const box = document.createElement('div');
      box.className = 'gacha-box';
      
      const banner = document.createElement('div');
      banner.className = 'banner';
      banner.style.backgroundImage = `linear-gradient(45deg, ${tier.colors[0]}, ${tier.colors[1]})`;
      banner.innerHTML = `
        <div class="banner-text">${tier.name}</div>
        <div class="banner-sub">${tier.sub}</div>
      `;

      const controls = document.createElement('div');
      controls.className = 'gacha-controls';
      controls.innerHTML = `
        <button class="gacha-btn btn-single" onclick="tryGacha(${tier.price}, 1)">
          ÂçòÁô∫„Ç¨„ÉÅ„É£
          <span class="cost-label">${tier.price.toLocaleString()} pt</span>
        </button>
        <button class="gacha-btn btn-10" onclick="tryGacha(${tier.price}, 10)">
          10ÈÄ£„Ç¨„ÉÅ„É£
          <span class="cost-label">${(tier.price * 10).toLocaleString()} pt</span>
        </button>
        <button class="gacha-btn btn-100" onclick="tryGacha(${tier.price}, 100)">
          100ÈÄ£„Ç¨„ÉÅ„É£
          <span class="cost-label">${(tier.price * 100).toLocaleString()} pt</span>
        </button>
      `;

      box.appendChild(banner);
      box.appendChild(controls);
      container.appendChild(box);
    });
  }

  function updateUI() {
    document.getElementById('headerPoints').innerText = userPoints.toLocaleString() + " pt";
  }

  // --- „Ç¨„ÉÅ„É£„É≠„Ç∏„ÉÉ„ÇØ ---
  let tempResults = [];
  let maxRarityVal = 0; // ÊºîÂá∫Áî®
  let currentAura = 0;

  function tryGacha(price, count) {
    const cost = price * count;
    // „ÉÜ„Çπ„Éà„É¢„Éº„Éâ„Å™„ÅÆ„Åß„Éù„Ç§„É≥„ÉàÊ∏õÁÆó„ÅØ„Ç≥„É°„É≥„Éà„Ç¢„Ç¶„Éà
    // if (userPoints < cost) { alert("„Éù„Ç§„É≥„Éà„ÅåË∂≥„Çä„Åæ„Åõ„ÇìÔºÅ"); return; }
    // userPoints -= cost; 
    
    updateUI();

    tempResults = [];
    maxRarityVal = 0;
    
    const targetTier = TIERS.find(t => t.price === price);
    const pool = targetTier.pool;
    const totalW = pool.reduce((a,c)=>a+c.w, 0);

    for(let i=0; i<count; i++){
      let r = Math.random() * totalW;
      let selected = pool[pool.length-1];
      for(let card of pool){
        r -= card.w;
        if(r < 0) { selected = card; break; }
      }
      
      const color = selected.r === 'SSR' ? '000000' : (selected.r === 'SR' ? 'aa8800' : '555555');
      const text = selected.r === 'SSR' ? 'GOD' : selected.r;
      const imgUrl = `https://placehold.jp/30/${color}/ffffff/150x225.png?text=${encodeURIComponent(text)}%0A${encodeURIComponent(selected.name)}`;

      const newCard = {
        uniqueId: Date.now() + Math.random(), 
        tier: price,
        rarity: selected.r,
        name: selected.name,
        point: selected.pt,
        img: imgUrl
      };
      
      tempResults.push(newCard);
      
      let v = 0;
      if(selected.r==='R') v=1;
      if(selected.r==='SR') v=2;
      if(selected.r==='SSR') v=3;
      if(v > maxRarityVal) maxRarityVal = v;
    }

    startAnimation();
  }

  // --- ÊºîÂá∫ ---
  function startAnimation() {
    const overlay = document.getElementById('cutinOverlay');
    overlay.style.display = 'flex';
    document.getElementById('cutinText').style.display = 'none';
    currentAura = 0;
    updateAura();
    
    document.getElementById('pushBtn').onclick = () => {
      const orb = document.getElementById('auraOrb');
      orb.style.animation = 'none';
      orb.offsetHeight; 
      orb.style.animation = 'shake-hard 0.2s';

      if (currentAura < maxRarityVal) {
        if(Math.random() < 0.4 || maxRarityVal === 3) {
          currentAura++;
          updateAura();
        }
      }
      
      if (currentAura === 3 || Math.random() < 0.15) {
        finishAnimation();
      }
    };
  }

  function updateAura() {
    const orb = document.getElementById('auraOrb');
    orb.className = 'aura-orb';
    if(currentAura === 0) orb.classList.add('blue');
    else if(currentAura === 1) orb.classList.add('green');
    else if(currentAura === 2) orb.classList.add('red');
    else if(currentAura >= 3) orb.classList.add('rainbow');
  }

  function finishAnimation() {
    document.getElementById('pushBtn').onclick = null;
    
    if(currentAura < maxRarityVal) {
      currentAura = maxRarityVal;
      updateAura();
    }

    if(maxRarityVal === 3) showCutin("Ë¶öÈÜí!!", showResult);
    else if(maxRarityVal === 2) showCutin("ÊøÄÁÜ±!!", showResult);
    else showResult();
  }

  function showCutin(text, callback) {
    const el = document.getElementById('cutinText');
    el.innerText = text;
    el.style.display = 'block';
    el.classList.remove('cutin-anim');
    el.offsetHeight;
    el.classList.add('cutin-anim');
    
    setTimeout(() => {
      document.getElementById('flashBang').classList.add('flash-active');
      setTimeout(() => {
        callback();
        document.getElementById('flashBang').classList.remove('flash-active');
        document.getElementById('cutinOverlay').style.display = 'none';
      }, 300);
    }, 800);
  }

  function showResult() {
    document.getElementById('cutinOverlay').style.display = 'none';
    const grid = document.getElementById('resultGrid');
    grid.innerHTML = "";
    
    tempResults.forEach((card, i) => {
      myCards.push(card);

      const el = document.createElement('div');
      el.className = `grid-card ${card.rarity}`;
      el.style.animation = `card-appear 0.3s ease forwards ${i*0.03}s`;
      el.style.opacity = "0";
      el.innerHTML = `
        <img src="${card.img}">
        <div class="info">
          <span style="color:${getRColor(card.rarity)}">${card.rarity}</span><br>
          ${card.point.toLocaleString()}pt
        </div>
      `;
      grid.appendChild(el);
    });
    document.getElementById('resultScreen').style.display = 'flex';
  }

  function closeResult() {
    document.getElementById('resultScreen').style.display = 'none';
  }

  function getRColor(r) {
    if(r==='SSR') return 'gold';
    if(r==='SR') return 'orange';
    return 'white';
  }

  // --- „Ç§„É≥„Éô„É≥„Éà„É™ & Â£≤Âç¥ ---
  
  function showMain() {
    document.querySelectorAll('.overlay-screen').forEach(el => el.style.display = 'none');
  }

  let selectedCards = new Set();

  function openInventory() {
    document.getElementById('inventoryScreen').style.display = 'flex';
    renderInventory();
  }

  function renderInventory() {
    const grid = document.getElementById('inventoryGrid');
    grid.innerHTML = "";
    selectedCards.clear();
    updateSellUI();

    if(myCards.length === 0) {
      grid.innerHTML = "<div style='color:#666; text-align:center; padding:20px; grid-column:1/-1;'>„Ç´„Éº„Éâ„ÇíÊåÅ„Å£„Å¶„ÅÑ„Åæ„Åõ„Çì</div>";
      return;
    }

    [...myCards].reverse().forEach(card => {
      const el = document.createElement('div');
      el.className = `grid-card ${card.rarity}`;
      el.dataset.id = card.uniqueId;
      el.innerHTML = `
        <img src="${card.img}">
        <div class="info">
          ${card.point.toLocaleString()}pt
        </div>
      `;
      
      el.onclick = () => {
        if(selectedCards.has(card.uniqueId)) {
          selectedCards.delete(card.uniqueId);
          el.classList.remove('selected');
        } else {
          selectedCards.add(card.uniqueId);
          el.classList.add('selected');
        }
        updateSellUI();
      };
      
      grid.appendChild(el);
    });
  }

  function updateSellUI() {
    const count = selectedCards.size;
    let totalVal = 0;
    
    selectedCards.forEach(uid => {
      const c = myCards.find(x => x.uniqueId === uid);
      if(c) totalVal += c.point;
    });

    document.getElementById('sellCount').innerText = count;
    document.getElementById('sellValue').innerText = totalVal.toLocaleString();
    document.getElementById('sellBtn').disabled = (count === 0);
  }

  function sellSelectedCards() {
    if(selectedCards.size === 0) return;
    if(!confirm(`${selectedCards.size}Êûö„ÅÆ„Ç´„Éº„Éâ„ÇíÂ£≤Âç¥„Åó„Åæ„Åô„ÅãÔºü`)) return;

    let sellTotal = 0;
    myCards = myCards.filter(c => {
      if(selectedCards.has(c.uniqueId)) {
        sellTotal += c.point;
        return false; 
      }
      return true;
    });

    userPoints += sellTotal;
    updateUI();
    renderInventory();
    alert(`${sellTotal.toLocaleString()} pt Áç≤Âæó„Åó„Åæ„Åó„ÅüÔºÅ`);
  }

</script>
</body>
</html>
